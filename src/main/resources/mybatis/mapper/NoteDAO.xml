<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.meomureum.springboot.dao.INoteDAO">
	<select id="listDAOBySCode" resultType="com.meomureum.springboot.dto.NoteDTO">
		select n.n_code, n.s_code, p.p_code, n.n_title, n.n_content, n.created_at,
         	   n.n_order, p.api_code, p.p_place as p_name, p.p_addr, p.p_tel, f.file_path
 		 from note n left join place p on (n.p_code = p.p_code) 
		 left join fileupload f on (p.p_code = f.target_code)
		 and f.target_type = 'PLACE' and f.file_order = 1
		 where s_code = #{s_code} 
		 order by n_order asc
	</select>
	<insert id="insertDAO">
		insert into note
		 values('S'||lpad(schedule_seq.nextval,5,'0'),#{s_code},#{p_code,jdbcType=VARCHAR},#{n_title},#{n_content},sysdate,#{n_order})
	</insert>
	<delete id="deleteDAO">
		delete from note where s_code = #{s_code}
	</delete>
</mapper>