<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.meomureum.springboot.dao.IReportDAO">

	<!-- 신고 등록 -->
    <insert id="insertReport" parameterType="com.meomureum.springboot.dto.ReportDTO">
        INSERT INTO report (
            rep_code, rep_category, m_code, rep_title, rep_content, target_code, created_at
        ) VALUES (
            'REP' || LPAD(report_seq.NEXTVAL, 4, '0'),
            #{rep_category},
            #{m_code},
            #{rep_title},
            #{rep_content},
            #{target_code},            
            SYSDATE
        )
    </insert>
    
	<!-- 신고 목록 조회 -->
    <select id="listReports" resultType="com.meomureum.springboot.dto.ReportDTO">
        SELECT rep_code, rep_category, m_code, rep_title, rep_content, created_at, target_code
        FROM report
        ORDER BY created_at DESC
    </select>
        
    <!-- 신고 삭제 (처리 후 목록에서 제거) -->
    <delete id="deleteReport" parameterType="String">
        DELETE FROM report WHERE rep_code = #{rep_code}
    </delete>
        
</mapper>

